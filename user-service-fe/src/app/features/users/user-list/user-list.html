<div class="user-list-container">
  <div class="header-section">
    <div class="header-content">
      <div class="title-section">
        <mat-icon class="header-icon">people</mat-icon>
        <h1 class="page-title">User Management</h1>
      </div>
      <p class="page-subtitle">View and manage all users with profiles</p>
    </div>
  </div>

  <mat-card class="users-card">
    <mat-card-header>
      <div class="card-header-content">
        <div class="search-section">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Search</mat-label>
            <input 
              matInput 
              [(ngModel)]="searchTerm" 
              (keyup.enter)="onSearch()"
              placeholder="Search by name">
            <button 
              mat-icon-button 
              matSuffix 
              (click)="onSearch()"
              [disabled]="loading">
              <mat-icon>search</mat-icon>
            </button>
          </mat-form-field>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content>
      @if (loading) {
        <div class="loading-container">
          <mat-spinner diameter="50"></mat-spinner>
          <p>Loading users...</p>
        </div>
      } @else {
        <div class="table-container">
          <table mat-table [dataSource]="dataSource" class="users-table">
            <!-- ID Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef>ID</th>
              <td mat-cell *matCellDef="let user">
                <span class="user-id">#{{ user.id }}</span>
              </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let user">
                <div class="user-name">
                  <mat-icon class="name-icon">person</mat-icon>
                  <span>{{ user.name }}</span>
                </div>
              </td>
            </ng-container>

            <!-- Email Column -->
            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef>Email</th>
              <td mat-cell *matCellDef="let user">
                <div class="user-email">
                  <mat-icon class="email-icon">email</mat-icon>
                  <span>{{ user.email }}</span>
                </div>
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>Status</th>
              <td mat-cell *matCellDef="let user">
                <span [class]="getStatusClass(user)">
                  {{ getStatusText(user) }}
                </span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="actions-header">Actions</th>
              <td mat-cell *matCellDef="let user" class="actions-cell">
                <button 
                  mat-icon-button 
                  [matTooltip]="isUserDisabled(user) ? 'Enable account' : 'Disable account'"
                  (click)="toggleAccountStatus(user)">
                  <mat-icon [class]="isUserDisabled(user) ? 'action-icon-enable' : 'action-icon-disable'">
                    {{ isUserDisabled(user) ? 'check_circle' : 'block' }}
                  </mat-icon>
                </button>
                <button 
                  mat-icon-button 
                  matTooltip="View details"
                  [routerLink]="['/users', user.id]">
                  <mat-icon class="action-icon-view">visibility</mat-icon>
                </button>
                <button 
                  mat-icon-button 
                  matTooltip="Delete account"
                  (click)="deleteAccount(user)">
                  <mat-icon class="action-icon-delete">delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
                [class]="row.isDeleted ? 'user-row user-disabled' : 'user-row'"></tr>

            <!-- No data row -->
            <tr class="no-data-row" *matNoDataRow>
              <td [attr.colspan]="displayedColumns.length" class="no-data-cell">
                <div class="no-data-content">
                  <mat-icon>people_outline</mat-icon>
                  <p>No users found</p>
                </div>
              </td>
            </tr>
          </table>
        </div>

        @if (pagination && pagination.total > 0) {
          <mat-paginator
            [length]="pagination.total"
            [pageSize]="pageSize"
            [pageIndex]="currentPage - 1"
            [pageSizeOptions]="[5, 10, 25, 50]"
            (page)="onPageChange($event)"
            showFirstLastButtons>
          </mat-paginator>
        }
      }
    </mat-card-content>
  </mat-card>
</div>

